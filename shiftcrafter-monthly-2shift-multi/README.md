# ShiftCrafter Part 5 — 多体系対応（月次・早/日/遅/夜＋時短）MVP

多体系シフト（**早出、日勤、遅出、夜勤**）に **時短日勤（例：9:00–16:00）** を組み込み、**1か月**のシフトをブラウザだけで自動割当。  
**CSV / ICS / 検証CSV** 出力に対応。データは外部送信しません（クライアントサイド完結）。

## 使い方（最短）

1. `index.html` をPCブラウザで開く（Chrome推奨）
2. 左パネルで以下を入力  
   - 対象月（YYYY-MM）  
   - 必要人数（**早出 / 日勤 / 遅出 / 夜勤**）  
   - 週あたり／（任意）月あたりの夜勤上限  
   - 職員（**フルタイム - 早/日/遅/夜 対応**）リスト  
   - 職員（**時短日勤のみ**）リスト  
   - 休み希望（例：`2025-11-03 田中`）  
   - 早出・遅出・時短の時刻設定（既定値あり）
3. 「シフト自動作成」→「CSV／ICS／検証CSV」をダウンロード

## 出力

- **schedule_multi.csv（wide）**  
  `date, dow, need_day, need_night, need_early, need_late, early_*, day_full_*, late_*, day_short_*, night_*`
- **shift_multi.ics**  
  - 早出: 例 07:00–15:30（UIで設定可）
  - 日勤（通常）: 08:30–17:00  
  - 日勤（時短）: 例 09:00–16:00（UIで設定可）  
  - 遅出: 例 11:30–20:00（UIで設定可）
  - 夜勤: 17:00–翌09:00  
  - `SUMMARY: 早出：氏名 / 日勤：氏名 / 遅出：氏名 / 夜勤：氏名 / 日勤(時短)：氏名`
- **validation_summary.csv**  
  - 早出・遅出・日勤・夜勤の合計回数
  - `consec_night_2plus`: 連続夜勤
  - `day_after_night_violation`: 夜勤明けの勤務（禁止ルールの監視）
  - `weekly_night_cap_violations` / `monthly_night_cap_violation`

## 割当ロジック（MVP）

1. **夜勤**を最優先で割当（週・月の夜勤上限、希望休を遵守）  
2. **早出**を次に割当  
3. **遅出**をその次に割当  
4. **日勤**は**通常**と**時短**（重み付き）で必要人数 (`need_day`) を充当  

> ※ 「Night→翌日勤務(早/日/遅/短) 禁止」、同日重複割当禁止。時短は日勤枠にのみ使用されます。

## 制約・注意

- MVPは**公平性最適化**（偏り抑制）を簡易ルールに留めています（回数の少ない人を優先）。  
- 必要人数は月内で共通です。  
- CSVはUTF-8（BOM付き）、ICSはAsia/Tokyoで出力。

## ライセンス

MIT
